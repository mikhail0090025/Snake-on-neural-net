<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake on neural net</title>
    <script src="NeuralNet.js"></script>
    <link rel="stylesheet" href="style.css">
    <!--
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet">
    -->
</head>
<body>
    <h3>Snake on neural net</h3>
    <canvas id="game_canv" width="600px" height="600px"></canvas>
    <div id="control-block">
        <button class="btn btn-primary" onclick="StepNN(0);">Neural netÂ´s step</button>
        <p>Gray - playing zone.<br>Black - not playing zone.</p>
    </div>
    <!-- Game JS script -->
    <script src="Game.js"></script>

    <script>
        let gen_size = 50;
        var gen = new Generation(12, 4, 30, 6, gen_size, RoundMethod.DontRound, RoundMethod.ZeroAndOne, RoundMethod.Tanh);
        console.log(gen);
        let playing = true;
        for (let i = 0; i < gen_size; i++) {
            while (playing) {
                StepNN(i);
            }
            playing = true;
        }
        alert(gen.BestNet().Score());
        function StepNN(index) {
            gen.Generation_[index].GetInputs(game.StateForNeuralNet());
            let res = gen.Generation_[index].Result();
            let step = res.indexOf(Math.max(...res));
            let step_result = game.Step(step, true);
            switch (step_result) {
                case 0:
                    gen.Generation_[index].ChangeScore(0.1);
                    break;
                case 1:
                    playing = false;
                    break;
                case 2:
                    gen.Generation_[index].ChangeScore(30);
                    break;
                default:
                    throw new Error("Unknown step result!");
                    break;
            }
        }
        /*gen.Generation_.forEach(element => {
            element.GetInputs(game.StateForNeuralNet());
            let res = element.Result();
            let step = res.indexOf(Math.max(res));
        });*/
    </script>
</body>
</html>